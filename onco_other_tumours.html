<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Senior lecturer, <br> Dept of Child Health,KNUST <br> Pediatric Oncologist">
<meta name="dcterms.date" content="2025-09-24">

<title>Other Pediatric Tumours</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="onco_other_tumours_files/libs/clipboard/clipboard.min.js"></script>
<script src="onco_other_tumours_files/libs/quarto-html/quarto.js"></script>
<script src="onco_other_tumours_files/libs/quarto-html/popper.min.js"></script>
<script src="onco_other_tumours_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="onco_other_tumours_files/libs/quarto-html/anchor.min.js"></script>
<link href="onco_other_tumours_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="onco_other_tumours_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="onco_other_tumours_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="onco_other_tumours_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="onco_other_tumours_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Other Pediatric Tumours</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>xxx </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Childhood cancers represent a diverse group of diseases distinct from adult malignancies in their biology, clinical behaviour, and response to treatment. While leukaemias, lymphomas, nephroblastoma, and retinoblastoma are among the most common, several other solid tumours also contribute significantly to paediatric cancer morbidity and mortality worldwide.</p>
<p>Understanding these conditions is crucial for early recognition, appropriate referral, and timely management. This chapter will cover neuroblastoma, hepatic tumours, sarcomas, bone tumours, brain tumours, and germ cell tumours, as well as selected rare entities.</p>
</section>
<section id="neuroblastoma" class="level2">
<h2 class="anchored" data-anchor-id="neuroblastoma">Neuroblastoma</h2>
<section id="introduction-and-epidemiology" class="level3">
<h3 class="anchored" data-anchor-id="introduction-and-epidemiology">Introduction and Epidemiology</h3>
<p>Neuroblastoma is the most common <strong>extracranial solid tumour of childhood</strong>, arising from neural crest cells of the sympathetic nervous system.<br>
- Accounts for about <strong>8–10% of childhood cancers</strong>.<br>
- Median age at diagnosis: <strong>2 years</strong>.<br>
- Rare after 10 years.<br>
- Common sites: adrenal medulla (40%), paraspinal sympathetic chain, posterior mediastinum.</p>
</section>
<section id="pathophysiology" class="level3">
<h3 class="anchored" data-anchor-id="pathophysiology">Pathophysiology</h3>
<ul>
<li>Originates from neural crest cells that fail to differentiate.<br>
</li>
<li>Tumour behaviour is highly variable: can spontaneously regress (especially in infants) or progress aggressively with widespread metastases.<br>
</li>
<li>Genetic features: amplification of <strong>MYCN oncogene</strong> is associated with poor prognosis.</li>
</ul>
</section>
<section id="clinical-features" class="level3">
<h3 class="anchored" data-anchor-id="clinical-features">Clinical Features</h3>
<ul>
<li>Abdominal mass (often firm, irregular, crossing midline).<br>
</li>
<li>Symptoms due to local invasion: constipation, urinary obstruction.<br>
</li>
<li>Metastases: bone pain, periorbital ecchymoses (“raccoon eyes”), hepatomegaly.<br>
</li>
<li>Paraneoplastic features: hypertension, diarrhoea (due to vasoactive intestinal peptide).</li>
</ul>
</section>
<section id="investigations" class="level3">
<h3 class="anchored" data-anchor-id="investigations">Investigations</h3>
<ul>
<li>Imaging: ultrasound, CT/MRI of abdomen.<br>
</li>
<li>MIBG scan: identifies tumour sites.<br>
</li>
<li>Biopsy for histology.<br>
</li>
<li>Elevated urinary catecholamines (VMA, HVA) in &gt;90%.</li>
</ul>
</section>
<section id="management" class="level3">
<h3 class="anchored" data-anchor-id="management">Management</h3>
<ul>
<li>Depends on risk stratification.<br>
</li>
<li>Low-risk: Surgery alone may cure.<br>
</li>
<li>Intermediate-risk: surgery + chemotherapy.<br>
</li>
<li>High-risk: intensive chemotherapy, surgery, radiotherapy, stem cell transplant, immunotherapy.</li>
</ul>
</section>
<section id="prognosis" class="level3">
<h3 class="anchored" data-anchor-id="prognosis">Prognosis</h3>
<ul>
<li>Variable. Infants with localised disease may do very well.<br>
</li>
<li>High-risk disease has poorer survival despite aggressive therapy.</li>
</ul>
</section>
</section>
<section id="hepatic-tumours" class="level2">
<h2 class="anchored" data-anchor-id="hepatic-tumours">Hepatic Tumours</h2>
<section id="hepatoblastoma" class="level3">
<h3 class="anchored" data-anchor-id="hepatoblastoma">Hepatoblastoma</h3>
<ul>
<li>Most common <strong>primary liver tumour in children</strong>.<br>
</li>
<li>Usually diagnosed in children under <strong>3 years</strong>.<br>
</li>
<li>Associated with prematurity and some genetic syndromes (e.g., Beckwith–Wiedemann).</li>
</ul>
<p><strong>Clinical Features</strong>:<br>
- Painless abdominal mass.<br>
- Abdominal distension.<br>
- Elevated <strong>alpha-fetoprotein (AFP)</strong> in most cases.</p>
<p><strong>Diagnosis</strong>:<br>
- Ultrasound/CT scan showing liver mass.<br>
- Biopsy for confirmation.</p>
<p><strong>Treatment</strong>:<br>
- Surgical resection (hepatectomy).<br>
- Neoadjuvant/adjuvant chemotherapy (cisplatin-based).<br>
- Liver transplant if unresectable.</p>
<p><strong>Prognosis</strong>:<br>
- Good if complete surgical removal is possible.</p>
</section>
<section id="hepatocellular-carcinoma-hcc" class="level3">
<h3 class="anchored" data-anchor-id="hepatocellular-carcinoma-hcc">Hepatocellular Carcinoma (HCC)</h3>
<ul>
<li>Less common in children but important in sub-Saharan Africa due to <strong>hepatitis B infection</strong>.<br>
</li>
<li>Presents in older children and adolescents.<br>
</li>
<li>AFP is elevated but less consistently than hepatoblastoma.<br>
</li>
<li>Prognosis is generally poor, as tumours are often unresectable.</li>
</ul>
</section>
</section>
<section id="rhabdomyosarcoma-and-other-soft-tissue-sarcomas" class="level2">
<h2 class="anchored" data-anchor-id="rhabdomyosarcoma-and-other-soft-tissue-sarcomas">Rhabdomyosarcoma and Other Soft Tissue Sarcomas</h2>
<section id="rhabdomyosarcoma-rms" class="level3">
<h3 class="anchored" data-anchor-id="rhabdomyosarcoma-rms">Rhabdomyosarcoma (RMS)</h3>
<ul>
<li>Most common <strong>soft tissue sarcoma in children</strong>.<br>
</li>
<li>Arises from primitive mesenchymal cells committed to skeletal muscle lineage.<br>
</li>
<li>Common sites: head and neck (orbit, nasopharynx), genitourinary tract, extremities.</li>
</ul>
<p><strong>Clinical Features</strong>:<br>
- Mass on the affected site.<br>
- Proptosis (orbital).<br>
- Nasal obstruction, epistaxis (nasopharyngeal).<br>
- Haematuria or vaginal bleeding (genitourinary).</p>
<p><strong>Diagnosis</strong>:<br>
- Imaging (MRI).<br>
- Biopsy with histology (embryonal, alveolar, pleomorphic subtypes).<br>
- Immunohistochemistry (desmin, myogenin positive).</p>
<p><strong>Treatment</strong>:<br>
- Multimodal: surgery, chemotherapy, radiotherapy.</p>
<p><strong>Prognosis</strong>:<br>
- Better in embryonal type.<br>
- Depends on site, size, and extent.</p>
</section>
<section id="other-soft-tissue-sarcomas" class="level3">
<h3 class="anchored" data-anchor-id="other-soft-tissue-sarcomas">Other Soft Tissue Sarcomas</h3>
<ul>
<li>Include fibrosarcoma, synovial sarcoma, and malignant peripheral nerve sheath tumour.<br>
</li>
<li>Less common but managed similarly with surgery, chemotherapy, and radiotherapy.</li>
</ul>
</section>
</section>
<section id="bone-tumours" class="level2">
<h2 class="anchored" data-anchor-id="bone-tumours">Bone Tumours</h2>
<section id="osteosarcoma" class="level3">
<h3 class="anchored" data-anchor-id="osteosarcoma">Osteosarcoma</h3>
<ul>
<li>Most common <strong>primary malignant bone tumour</strong> in children and adolescents.<br>
</li>
<li>Peak in adolescence during rapid bone growth.<br>
</li>
<li>Common sites: metaphyses of long bones (femur, tibia, humerus).</li>
</ul>
<p><strong>Clinical Features</strong>:<br>
- Localised bone pain (worse at night).<br>
- Swelling, mass, limitation of movement.<br>
- Pathological fractures may occur.</p>
<p><strong>Investigations</strong>:<br>
- X-ray: mixed lytic-sclerotic lesion, periosteal reaction (“sunburst” appearance, Codman triangle).<br>
- MRI: local extent.<br>
- Biopsy confirms diagnosis.</p>
<p><strong>Treatment</strong>:<br>
- Neoadjuvant chemotherapy, limb-sparing surgery (or amputation), adjuvant chemotherapy.</p>
<p><strong>Prognosis</strong>:<br>
- Improved with multimodal therapy.<br>
- Presence of metastases (lung) worsens outlook.</p>
</section>
<section id="ewing-sarcoma" class="level3">
<h3 class="anchored" data-anchor-id="ewing-sarcoma">Ewing Sarcoma</h3>
<ul>
<li>Second most common bone tumour in children.<br>
</li>
<li>Arises from primitive neuroectodermal cells.<br>
</li>
<li>Typically affects diaphysis of long bones and pelvis.<br>
</li>
<li>Associated with <strong>t(11;22) translocation</strong>.</li>
</ul>
<p><strong>Clinical Features</strong>:<br>
- Pain, swelling, systemic symptoms (fever, weight loss).<br>
- Can mimic infection (osteomyelitis).</p>
<p><strong>Investigations</strong>:<br>
- X-ray: “onion-skin” periosteal reaction.<br>
- MRI: extent of disease.<br>
- Biopsy for histology and cytogenetics.</p>
<p><strong>Treatment</strong>:<br>
- Chemotherapy, surgery, and/or radiotherapy.</p>
<p><strong>Prognosis</strong>:<br>
- Fair with localised disease.<br>
- Poor with metastases.</p>
</section>
</section>
<section id="brain-tumours" class="level2">
<h2 class="anchored" data-anchor-id="brain-tumours">Brain Tumours</h2>
<p>Brain tumours are the most common <strong>solid tumours of childhood</strong>.</p>
<section id="medulloblastoma" class="level3">
<h3 class="anchored" data-anchor-id="medulloblastoma">Medulloblastoma</h3>
<ul>
<li>Most common malignant brain tumour in children.<br>
</li>
<li>Originates in cerebellum.<br>
</li>
<li>Highly radiosensitive.</li>
</ul>
<p><strong>Features</strong>: headache, vomiting, ataxia, papilloedema.<br>
<strong>Treatment</strong>: surgery + craniospinal irradiation + chemotherapy.</p>
</section>
<section id="astrocytomas" class="level3">
<h3 class="anchored" data-anchor-id="astrocytomas">Astrocytomas</h3>
<ul>
<li>Low-grade astrocytomas (e.g., pilocytic astrocytoma) have excellent prognosis after surgical removal.<br>
</li>
<li>High-grade astrocytomas are aggressive and carry poorer outcomes.</li>
</ul>
</section>
<section id="ependymomas" class="level3">
<h3 class="anchored" data-anchor-id="ependymomas">Ependymomas</h3>
<ul>
<li>Arise from ependymal cells lining ventricles.<br>
</li>
<li>Commonly present with hydrocephalus due to obstruction.<br>
</li>
<li>Treatment: surgery and radiotherapy.</li>
</ul>
</section>
</section>
<section id="germ-cell-tumours" class="level2">
<h2 class="anchored" data-anchor-id="germ-cell-tumours">Germ Cell Tumours</h2>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<ul>
<li>Can occur in gonads (testis, ovary) or extragonadal sites (sacrococcygeal, mediastinum, retroperitoneum).<br>
</li>
<li>Derived from primordial germ cells.</li>
</ul>
</section>
<section id="clinical-features-1" class="level3">
<h3 class="anchored" data-anchor-id="clinical-features-1">Clinical Features</h3>
<ul>
<li>Testicular: painless testicular mass.<br>
</li>
<li>Ovarian: abdominal mass, pain, precocious puberty.<br>
</li>
<li>Sacrococcygeal: mass at base of spine, sometimes visible externally.</li>
</ul>
</section>
<section id="diagnosis" class="level3">
<h3 class="anchored" data-anchor-id="diagnosis">Diagnosis</h3>
<ul>
<li>Imaging (ultrasound, CT/MRI).<br>
</li>
<li>Serum tumour markers: AFP, β-HCG.<br>
</li>
<li>Biopsy (except in some gonadal cases where orchiectomy/oophorectomy is primary treatment).</li>
</ul>
</section>
<section id="treatment" class="level3">
<h3 class="anchored" data-anchor-id="treatment">Treatment</h3>
<ul>
<li>Surgery + chemotherapy (cisplatin-based).<br>
</li>
<li>Prognosis generally good, especially for localised disease.</li>
</ul>
</section>
</section>
<section id="other-rare-paediatric-tumours" class="level2">
<h2 class="anchored" data-anchor-id="other-rare-paediatric-tumours">Other Rare Paediatric Tumours</h2>
<ul>
<li><strong>Adrenocortical tumours</strong>: may present with virilisation or Cushing’s syndrome.<br>
</li>
<li><strong>Thyroid carcinoma</strong>: uncommon, but papillary carcinoma can occur, sometimes associated with prior radiation exposure.<br>
</li>
<li><strong>Malignant rhabdoid tumour of the kidney or brain</strong>: rare and aggressive.</li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Beyond leukaemia, lymphoma, nephroblastoma, and retinoblastoma, several other paediatric malignancies play a significant role in the spectrum of childhood cancer. These include neuroblastoma, hepatic tumours, sarcomas, bone tumours, brain tumours, and germ cell tumours. Although they differ in biology and clinical behaviour, successful management relies on <strong>early diagnosis, multidisciplinary care, and supportive management</strong>.</p>
<p>In resource-limited settings such as Ghana, improving survival will require increased awareness of early signs, timely referral, access to diagnostic facilities, and strengthening of paediatric oncology units.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>